{% load static %}
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" /> -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="{% static 'css/feed/feedddd.css' %}">
        <link href="https://fonts.googleapis.com/css2?family=Belanosima:wght@400;600;700&family=Eczar:wght@500;600;700;800&family=Playfair+Display:ital,wght@0,700;0,800;0,900;1,700;1,800;1,900&family=Poppins:wght@400;500;600&family=Roboto:wght@400;500;700&family=Rubik:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">    
        <script src="https://kit.fontawesome.com/9702b0450a.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
            <div class="header_top">
                <i class="fa-solid fa-plane-departure logo"></i>
                {% if request.user.image_profile == '' %}
                <a href="{% url 'profile' user=request.user.username%}" class="user"><img src="{% static 'images/profile.png' %}"></a>
                {% else %}
                <a href="{% url 'profile' user=request.user.username %}" class="user"><img src="{% url 'get_image_user'  image=request.user.image_profile user=request.user.username%}"></a>
                {% endif %}
            </div>
            {% include 'core/header.html' %}

            <i class="fa-solid fa-spinner load"></i>
            
            <div class="section">
                <div class="header_web"> 
                    <header class="header">
                        <ul class="options_header">
                            <li class="option_header"><a href="{% url 'feed' %}"><i class="fa-solid fa-house"></i> Inicio</a></li>
                            <li class="option_header"><a><i class="fa-solid fa-magnifying-glass search"></i> Buscar</a></li>
                            <li class="option_header"><a href=""><i class="fa-solid fa-earth-americas world"></i> Trivia</a></li>
                            <li class="option_header"><a><i class="fa-solid fa-gear"></i> Ajustes</a></li>    
                        </ul>
                    </header>
                    <div class="add_window">
                        <a href="{% url 'new_message' %}">Nuevo mensaje</a>
                        <a href="{% url 'new_trip' %}">Nuevo viaje</a>
                    </div>
                    <div class="search_window">
                        <form method="post" class="form_search">
                            {% csrf_token %}
                            <div class="div_input">
                                <input type="search" name="result" class="input_result" required placeholder="Escriba el nombre de un usuario o destino">
                                <i class="fa-solid fa-xmark close"></i>
                            </div>
                            <input type="submit" value="Buscar">
                        </form>
                        <p class="not_results"></p>
                        <div class="users_results">
                            <p>Usuarios</p>
                            <ul class="list_users">
                            </ul>
                        </div>
                        <div class="countries_results">
                            <p>Paises</p>
                            <ul class="list_countries">
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="section_center">
                    <div class="div_form_message">
                        <form method='POST' class="form_new_message">
                            {% csrf_token %}
                            <select name="location">
                                <option>¿De que lugar deseas hablar?</option>
                            {% for c in countries %}
                                <option>{{c.name}}</option>
                            {% endfor %}
                            </select>
                            <div class="div_form_submit">
                                <div class="div_form_textarea">
                                    {{form_new_message.message}}
                                </div>
                                <div class="div_form_button_submit">
                                    <i class="fa-regular fa-paper-plane"></i>
                                    <input type="submit" value="Subir" class="submit">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="publications">
                        
                        {% if list_messages|length == 0 %}
                        <p class="length_messages">No hay mensajes disponibles.<br><br>¡Sigue a otros usuarios o publica tus propios mensajes!</p>
                        {% else %}
                            {% for m in list_messages %}
                            <div class="publication">
                                <div class="info_publication">
                                    <a href="{% url 'profile' user=m.user.username%}">
                                    {% if m.user.image_profile != '' %}
                                    <img class="image_publication" src="{% url 'get_image_user' image=m.user.image_profile user=m.user.username%}">
                                    {% else %}
                                    <img class="image_publication" src="{% static 'images/profile.png' %}">
                                    {% endif %}        
                                    </a>                    
                                    <div class="info_user">
                                        <p class="name_publication">{{m.user.first_name}}</p>
                                        <p class="user_publication">@{{m.user.username}}</p>
                                    </div>
                                    <p class="date_publication">{{m.date|date:'d M'}}</p>
                                </div>
                                <p class="location_publication">{{m.location}}</p>
                                <p class="message_publication">{{m.message}}</p>
                                <p class="likes_publication"><i class="fa-regular fa-heart"></i> {{m.likes}}</p>
                            </div>
                            
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div class="suggestions">
                    <p class="title_suggestions">Sugerencias</p>
                    <div class="list_suggestions">
                        {% for el in list_suggestions %}
                        <div class="suggestion">
                            {% if el.image_profile != '' %}
                                <img class="image_publication" src="{% url 'get_image_user' image=el.image_profile user=el.username%}">
                            {% else %}
                                <img class="image_publication" src="{% static 'images/profile.png' %}">
                            {% endif %}
                            <a>{{el}}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script src="{% static 'js/feed/feed.js' %}"></script>
</html>